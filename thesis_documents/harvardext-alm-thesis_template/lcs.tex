
\begin{algorithm}
  \caption{\algor{LCS}($A_{0..n},B_{0..m}$)}
  \label{algo:LCS}
\begin{lstlisting}[language=Algorithm]
$S_{i,j} \as 0 $ for all $i = 0$ or $j = 0$		{set first row and first column to $0$}
$T_{i,j} \as \sym{UP}$ for all $i,j$			{pointing up by default}

for $i \as 1$ to $n$ do
   for $j \as 1$ to $m$ do
      $S_{i,j} = \max 
\begin{cases}
  S_{i,j-1} & \\
  S_{i-1,j} & \\
  S_{i-1,j-1} + 1 & \textrm{if } A_i = B_j
\end{cases}$
      $T_{i,j} = 
\begin{cases}
  \sym{LEFT} & \textrm{if } S_{i,j} = S_{i,j-1}\\
  \sym{UP} & \textrm{if } S_{i,j} = S_{i-1,j}\\
  \sym{DIAGONAL} & \textrm{if } S_{i,j} = S_{i-1,j-1} + 1
\end{cases}$
$\algor{Backtrace}(A,T, n, m)$

function $\algor{Backtrace}(A_{0..n},T_{0..n\times 0..m}, i, j)$
   if $i = 0$ or $j = 0$ then
      return
   if $T_{i,j} = \sym{DIAGONAL}$ then
      $\algor{Backtrace}(A,T_{n,m}, i-1, j-1)$
      print $A_i$
   else if $T_{i,j} = \sym{UP}$ then
      $\algor{Backtrace}(A,T, i-1, j)$
   else 
      $\algor{Backtrace}(A,T, i, j-1)$
end
\end{lstlisting}
\end{algorithm}

